<!DOCTYPE html>
<html>
<head>
    <title>Test Word Synchronization</title>
</head>
<body>
    <h1>Word Synchronization Test</h1>
    <div id="status">Loading...</div>
    <div id="functions">
        <button onclick="testGetWord()">Test Get Current Word</button>
        <button onclick="testSetWord()">Test Set Current Word</button>
        <button onclick="testWatchWord()">Test Watch Current Word</button>
    </div>
    <div id="output"></div>

    <!-- Load the existing index.html Firebase setup -->
    <script type="module">
        // Copy the Firebase setup from index.html
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getDatabase, ref, get, child, set, onValue } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBifPmI9SvYUmWFZDQ18Twje6NsBjKbdWQ",
            authDomain: "wordle-e76d9.firebaseapp.com",
            databaseURL: "https://wordle-e76d9-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "wordle-e76d9",
            storageBucket: "wordle-e76d9.firebasestorage.app",
            messagingSenderId: "408477836472",
            appId: "1:408477836472:web:1b3a28a5d2cc4b307a404d",
            measurementId: "G-NCN7FEP1EC"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Set up test functions
        window.testGetWord = function() {
            const mode = 'test';
            get(child(ref(db), `gameSettings/${mode}/currentWord`)).then((snapshot) => {
                if (snapshot.exists()) {
                    const word = snapshot.val();
                    document.getElementById('output').innerHTML += `<p>Current word: ${word}</p>`;
                } else {
                    document.getElementById('output').innerHTML += `<p>No current word found</p>`;
                }
            }).catch((error) => {
                document.getElementById('output').innerHTML += `<p>Error: ${error}</p>`;
            });
        };

        window.testSetWord = function() {
            const mode = 'test';
            const testWord = 'בדיקה';
            set(ref(db, `gameSettings/${mode}/currentWord`), testWord).then(() => {
                document.getElementById('output').innerHTML += `<p>Set word to: ${testWord}</p>`;
            }).catch((error) => {
                document.getElementById('output').innerHTML += `<p>Error setting word: ${error}</p>`;
            });
        };

        window.testWatchWord = function() {
            const mode = 'test';
            const wordRef = ref(db, `gameSettings/${mode}/currentWord`);
            onValue(wordRef, (snapshot) => {
                if (snapshot.exists()) {
                    const word = snapshot.val();
                    document.getElementById('output').innerHTML += `<p>Word changed to: ${word}</p>`;
                }
            });
            document.getElementById('output').innerHTML += `<p>Watching for word changes...</p>`;
        };

        document.getElementById('status').innerHTML = 'Firebase loaded successfully!';
    </script>
</body>
</html>